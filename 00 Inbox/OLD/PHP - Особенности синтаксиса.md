#ЯП #PHP #Синтаксис

Здесь собраны специфичные особенности PHP.

---
## Базовые отличия

- Вставка в HTML: `<?php ... ?>`. Сокращенный вывод: `<?= $var ?>`.
- Динамическая типизация. 
- Блоки циклов и `if` **не образуют локальную область видимости** (переменная из цикла доступна снаружи).
## Уникальные операторы

### Spaceship (Космический корабль) `<=>`

Сравнивает два выражения и взависимости от их сопоставления возвращает `-1`, `0` или `1`.

```php
$x = 3 <=> 2; // 1  (левое больше)
$y = 2 <=> 2; // 0  (равны)
$z = 1 <=> 2; // -1 (левое меньше)
```
## `match` вместо `switch` (PHP 8.0)

В отличи от `switch`, конструкция `match`:
1. Возвращает значение.
2. Делает сравнение по типу и значению.
3. Не требует оператора `break`.

```php
$result = match($status_code) {
    200, 300 => "Успех или редирект",
    400 => "Ошибка клиента",
    default => "Неизвестный статус",
};
```

## Работы с функциями
### Замыкания

По умолчанию анонимные функции в PHP не видят внешние переменные. Если необходимо передать такие внутрь функции, то используется функция `use`:

```php
$multiplier = 2;
// Без use($multiplier) будет ошибка
$double = function($num) use($multiplier) {
    return $num * $multiplier;
};
```

> *Стрелочные функции (fn() => ...) захватывают внешние переменные автоматически.*
### Глобальные переменные

Обратиться к глобальным переменным внутри функции можно либо через ключевое слово `global`, либо используя специальный суперглобальный массив:

```php
$GLOBALS["x"] = 42;
```
## Магические константы

Меняют свое значение в зависимости от контекста выполнения (где они написаны):
- `__FILE__` и `__DIR__` — путь к файлу / папке (топ для инклудов файлов).
- `__LINE__` — текущая строка (полезно для логов ошибок).
- `__CLASS__` / `__METHOD__` — имя текущего класса/метода.
## Специфика массивов

Массивы в PHP всегда представляют из себя упорядоченные хэш-таблицы.

- **Сдвиг индексов:** Если переопределить индекс лишь для одного элемента (`$arr[10] = "a"`), следующий \[] добавит элемент под индексом 11.

```php
$x = 1; $y = 2;
// Берет имена переменных как строки и создает ассоциативный массив
$data = compact("x", "y"); // ["x" => 1, "y" => 2]
```
- Создание ассоциативных массивов из переменных.